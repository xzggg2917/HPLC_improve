<!DOCTYPE html>
<html>
<head>
    <title>æµ‹è¯• HPLC Gradient æ•°æ®</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        button { margin: 10px; padding: 10px; font-size: 14px; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 4px; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>HPLC Gradient æ•°æ®æµ‹è¯•å·¥å…·</h1>
    
    <button onclick="checkData()">æ£€æŸ¥ localStorage æ•°æ®</button>
    <button onclick="triggerEvent()">è§¦å‘ gradientDataUpdated äº‹ä»¶</button>
    <button onclick="clearData()">æ¸…ç©º Gradient æ•°æ®</button>
    
    <div id="output"></div>
    
    <script>
        function checkData() {
            const output = document.getElementById('output');
            let html = '<h2>æ•°æ®æ£€æŸ¥ç»“æœ:</h2>';
            
            // æ£€æŸ¥ Gradient æ•°æ®
            const gradientData = localStorage.getItem('hplc_gradient_data');
            if (gradientData) {
                try {
                    const parsed = JSON.parse(gradientData);
                    html += '<h3 class="success">âœ… Gradient æ•°æ®å­˜åœ¨</h3>';
                    html += '<pre>' + JSON.stringify(parsed, null, 2) + '</pre>';
                } catch (e) {
                    html += '<h3 class="error">âŒ Gradient æ•°æ®æ ¼å¼é”™è¯¯</h3>';
                    html += '<p>' + e.message + '</p>';
                }
            } else {
                html += '<h3 class="error">âŒ Gradient æ•°æ®ä¸å­˜åœ¨</h3>';
            }
            
            // æ£€æŸ¥ Methods æ•°æ®
            const methodsData = localStorage.getItem('hplc_methods_raw');
            if (methodsData) {
                try {
                    const parsed = JSON.parse(methodsData);
                    html += '<h3 class="success">âœ… Methods æ•°æ®å­˜åœ¨</h3>';
                    html += '<pre>' + JSON.stringify(parsed, null, 2) + '</pre>';
                } catch (e) {
                    html += '<h3 class="error">âŒ Methods æ•°æ®æ ¼å¼é”™è¯¯</h3>';
                }
            } else {
                html += '<h3 class="error">âŒ Methods æ•°æ®ä¸å­˜åœ¨</h3>';
            }
            
            // æ£€æŸ¥ Factors æ•°æ®
            const factorsData = localStorage.getItem('hplc_factors_data');
            if (factorsData) {
                try {
                    const parsed = JSON.parse(factorsData);
                    html += '<h3 class="success">âœ… Factors æ•°æ®å­˜åœ¨ (' + parsed.length + ' ä¸ªè¯•å‰‚)</h3>';
                    html += '<pre>' + JSON.stringify(parsed, null, 2) + '</pre>';
                } catch (e) {
                    html += '<h3 class="error">âŒ Factors æ•°æ®æ ¼å¼é”™è¯¯</h3>';
                }
            } else {
                html += '<h3 class="error">âŒ Factors æ•°æ®ä¸å­˜åœ¨</h3>';
            }
            
            output.innerHTML = html;
        }
        
        function triggerEvent() {
            console.log('ğŸ”” æ‰‹åŠ¨è§¦å‘ gradientDataUpdated äº‹ä»¶');
            window.dispatchEvent(new Event('gradientDataUpdated'));
            alert('å·²è§¦å‘ gradientDataUpdated äº‹ä»¶ï¼Œè¯·æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°');
        }
        
        function clearData() {
            if (confirm('ç¡®å®šè¦æ¸…ç©º Gradient æ•°æ®å—ï¼Ÿ')) {
                localStorage.removeItem('hplc_gradient_data');
                alert('Gradient æ•°æ®å·²æ¸…ç©º');
                checkData();
            }
        }
        
        // ç›‘å¬äº‹ä»¶
        window.addEventListener('gradientDataUpdated', () => {
            console.log('âœ… æ”¶åˆ° gradientDataUpdated äº‹ä»¶');
        });
        
        // è‡ªåŠ¨æ£€æŸ¥æ•°æ®
        checkData();
    </script>
</body>
</html>
